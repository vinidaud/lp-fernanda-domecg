<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card√°pio Sem Drama | Fernanda Domecg</title>
</head>
<body>
<script>
const links = [
    'https://lp.fernandadomecg.com.br/m6s-f',
    'https://lp.fernandadomecg.com.br/m6s-g'
];

// Probabilidades: 50% para cada
const probabilities = [50, 50];

let utms = {};
const parametros = ["utm_source", "utm_medium", "utm_campaign", "utm_term", "utm_content"];
const r = new URL(window.location.href);

parametros.forEach(el => {
    if (el === "utm_source") {
        utms[el] = r.searchParams.get(el) || (document.referrer ? new URL(document.referrer).hostname : "direto");
    } else {
        utms[el] = r.searchParams.get(el) || "";
    }
});

// Adicionar fbclid e gclid se estiverem presentes na URL
const extraParams = ["fbclid", "gclid", "sck", "src"];
extraParams.forEach(param => {
    const value = r.searchParams.get(param);
    if (value) {
        utms[param] = value;
    }
});

// Constroi a query string
const href = Object.keys(utms)
    .map(el => el + '=' + encodeURIComponent(utms[el]))
    .filter(el => el.split('=')[1] !== '')
    .join('&');

// Calcula probabilidade
const totalProbability = probabilities.reduce((total, probability) => total + probability, 0);
const random = Math.random() * totalProbability;

let redirectIndex = 0;
let cumulativeProbability = 0;

for (let i = 0; i < probabilities.length; i++) {
    cumulativeProbability += probabilities[i];
    if (random < cumulativeProbability) {
        redirectIndex = i;
        break;
    }
}

// Redireciona
const finalUrl = href ? links[redirectIndex] + '?' + href : links[redirectIndex];
window.location.replace(finalUrl);
</script>
</body>
</html>
